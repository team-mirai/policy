# PR åˆ†æç®¡ç†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã€team-mirai/policy ãƒªãƒã‚¸ãƒˆãƒªã® 400 ä»¶ã® README ãƒ©ãƒ™ãƒ«ä»˜ã PR ã®åˆ†æãƒ»ç®¡ç†ã‚’è¡Œã†ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™ã€‚

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### ğŸ“Š ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«

- **`readme-pr.yaml`** - 400 ä»¶ã™ã¹ã¦ã® PR æƒ…å ±ã‚’çµ±åˆç®¡ç†ã™ã‚‹ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
  - PR åŸºæœ¬æƒ…å ±ï¼ˆç•ªå·ã€ã‚¿ã‚¤ãƒˆãƒ«ã€çŠ¶æ…‹ã€ä½œæˆæ—¥ã€ä½œæˆè€…ã€URLï¼‰
  - ãƒ©ãƒ™ãƒ«æ›´æ–°çŠ¶æ³ï¼ˆ`label_updated: true/false`ï¼‰
  - åˆ†é¡æƒ…å ±ï¼ˆ`old_label`, `new_label`, `classification_reason`ï¼‰
  - åˆ†æãƒ¡ãƒ¢ï¼ˆ`analysis_notes`ï¼‰
  - çµ±è¨ˆæƒ…å ±ã¨ãƒãƒƒãƒå‡¦ç†è¨ˆç”»

### ğŸ“ å®Ÿè¡Œãƒ­ã‚°

- **`log.md`** - ãƒ©ãƒ™ãƒ«æ›´æ–°å®Ÿè¡Œãƒ­ã‚°
  - `gh pr edit` ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œå±¥æ­´
  - å„ PR ã®ãƒ©ãƒ™ãƒ«å¤‰æ›´çµæœ
  - å‡¦ç†æ—¥æ™‚ã¨çµæœçµ±è¨ˆ

## ğŸ”„ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### 1. åˆ†æãƒ•ã‚§ãƒ¼ã‚º

1. æœªå‡¦ç† PRï¼ˆ`label_updated: false`ï¼‰ã‚’ 10-20 ä»¶é¸æŠ
2. GitHub API ã§ PR ã®è©³ç´°æƒ…å ±ï¼ˆdescription, diffï¼‰ã‚’å–å¾—
3. Claude-4-Sonnet ã§å†…å®¹ã‚’å…¨æ–‡åˆ†æ
4. 13 ç¨®é¡ã®æ”¿ç­–ãƒ©ãƒ™ãƒ«ã‹ã‚‰æœ€é©ãªã‚‚ã®ã‚’é¸æŠ
5. `readme-pr.yaml`ã®`new_label`ã¨`analysis_notes`ã‚’æ›´æ–°

### 2. ãƒ©ãƒ™ãƒ«æ›´æ–°ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆç¾åœ¨ã¯ç¦æ­¢ä¸­ï¼‰

1. åˆ†ææ¸ˆã¿ PR ã«å¯¾ã—ã¦`gh pr edit`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
2. README ãƒ©ãƒ™ãƒ«ã‚’å‰Šé™¤ã—ã€æ–°ã—ã„æ”¿ç­–ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ 
3. `label_updated: true`ã«æ›´æ–°
4. å®Ÿè¡Œãƒ­ã‚°ã‚’`log.md`ã«è¨˜éŒ²

## ğŸ“ˆ é€²æ—çŠ¶æ³

- **ç· PR æ•°**: 401 ä»¶
- **å‡¦ç†æ¸ˆã¿**: 20 ä»¶ï¼ˆ5.0%ï¼‰
- **åˆ†ææ¸ˆã¿ï¼ˆæœªãƒ©ãƒ™ãƒ«æ›´æ–°ï¼‰**: 10 ä»¶
- **æœªå‡¦ç†**: 371 ä»¶

## ğŸ·ï¸ åˆ©ç”¨å¯èƒ½ãªæ”¿ç­–ãƒ©ãƒ™ãƒ«

1. **[ã‚·ã‚¹ãƒ†ãƒ ]** - ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®æ§‹æˆã‚„é‹ç”¨ã‚·ã‚¹ãƒ†ãƒ 
2. **ãã®ä»–æ”¿ç­–** - ä¸Šè¨˜ã‚«ãƒ†ã‚´ãƒªã«è©²å½“ã—ãªã„æ”¿ç­–ææ¡ˆ
3. **ã‚¨ãƒãƒ«ã‚®ãƒ¼** - ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¿ç­–
4. **ãƒ‡ã‚¸ã‚¿ãƒ«æ°‘ä¸»ä¸»ç¾©** - æ”¿æ²»å‚åŠ ã‚„æ°‘ä¸»ä¸»ç¾©ã®ç™ºå±•
5. **ãƒ“ã‚¸ãƒ§ãƒ³** - å›½å®¶ãƒ“ã‚¸ãƒ§ãƒ³ã‚„å°†æ¥æ§‹æƒ³
6. **åŒ»ç™‚** - åŒ»ç™‚åˆ¶åº¦ã‚„å¥åº·æ”¿ç­–
7. **å­è‚²ã¦** - å­è‚²ã¦æ”¯æ´ã‚„å…ç«¥ç¦ç¥‰
8. **æ•™è‚²** - æ•™è‚²åˆ¶åº¦ã‚„å­¦ç¿’ç’°å¢ƒ
9. **ç”£æ¥­æ”¿ç­–** - ç”£æ¥­æŒ¯èˆˆã‚„è¾²æ¥­æ”¿ç­–
10. **ç¦ç¥‰** - ç¤¾ä¼šä¿éšœåˆ¶åº¦ã‚„ç¦ç¥‰æ”¿ç­–
11. **ç§‘å­¦æŠ€è¡“** - ç§‘å­¦æŠ€è¡“æ”¿ç­–
12. **çµŒæ¸ˆè²¡æ”¿** - çµŒæ¸ˆæ”¿ç­–ã‚„è²¡æ”¿åˆ¶åº¦
13. **è¡Œæ”¿æ”¹é©** - è¡Œæ”¿æ‰‹ç¶šãã®æ”¹é©ã‚„ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–

## ğŸ¯ ç›®æ¨™

- 400 ä»¶ã™ã¹ã¦ã® PR ã‚’é©åˆ‡ãªæ”¿ç­–ãƒ©ãƒ™ãƒ«ã§åˆ†é¡
- ä½“ç³»çš„ãªæ”¿ç­–è­°è«–ã®åŸºç›¤æ§‹ç¯‰
- åŠ¹ç‡çš„ãª PR ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ç¢ºç«‹
- æ”¿ç­–åˆ†é‡åˆ¥ã®è­°è«–æ´»æ€§åŒ–

## ğŸ“ ãƒ¡ãƒ¢

- åˆ†æã¯ Claude-4-Sonnet ã«ã‚ˆã‚‹å…¨æ–‡èª­è§£ã§å®Ÿæ–½
- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ã¯ãªãã€æ–‡è„ˆã‚’ç†è§£ã—ãŸåˆ†é¡
- è¤‡æ•°åˆ†é‡ã«ã¾ãŸãŒã‚‹å ´åˆã¯æœ€ã‚‚ä¸­å¿ƒçš„ãªãƒ†ãƒ¼ãƒã‚’é¸æŠ
- åˆ†é¡ç†ç”±ã¨åˆ†æãƒ¡ãƒ¢ã‚’è©³ç´°ã«è¨˜éŒ²

---

## ğŸ¤– AI ä½œæ¥­è€…å‘ã‘ã‚¬ã‚¤ãƒ‰

### å‰ææ¡ä»¶

- GitHub CLI (`gh`) ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»èªè¨¼æ¸ˆã¿
- Python 3.x ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- `pyyaml` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- Cursor ä¸Šã§ Claude-4-Sonnet ã‚’ä½¿ç”¨å¯èƒ½

### ğŸ“‹ ä½œæ¥­æ‰‹é †ï¼ˆ10 ä»¶ãƒãƒƒãƒåˆ†æï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ— 1: ç’°å¢ƒç¢ºèª

```bash
# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd /path/to/team-mirai/policy/.pr_analysis

# ç¾åœ¨ã®é€²æ—ç¢ºèª
grep -c "label_updated: false" readme-pr.yaml
```

#### ã‚¹ãƒ†ãƒƒãƒ— 2: åˆ†æå¯¾è±¡ PR ã®é¸å®š

```python
#!/usr/bin/env python3
# analyze_batch.py
import yaml

def get_next_batch(limit=10):
    with open('readme-pr.yaml', 'r', encoding='utf-8') as f:
        data = yaml.safe_load(f)

    unprocessed = []
    for pr in data['pull_requests']:
        if pr.get('label_updated') == False and pr.get('new_label') is None:
            unprocessed.append(pr['number'])
            if len(unprocessed) >= limit:
                break

    return unprocessed

# æ¬¡ã®10ä»¶ã‚’å–å¾—
next_batch = get_next_batch(10)
print("æ¬¡ã®åˆ†æå¯¾è±¡PR:", next_batch)
```

#### ã‚¹ãƒ†ãƒƒãƒ— 3: PR è©³ç´°æƒ…å ±ã®å–å¾—

å„ PR ã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§è©³ç´°æƒ…å ±ã‚’å–å¾—ï¼š

```bash
# PRåŸºæœ¬æƒ…å ±
gh pr view {PR_NUMBER} --json title,body,state,author,url,createdAt

# PRå·®åˆ†
gh pr diff {PR_NUMBER}
```

**é‡è¦**: å„ PR ã®å†…å®¹ã‚’ `pr_{NUMBER}_analysis.md` ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã€ä»¥ä¸‹ã®å½¢å¼ã§æ•´ç†ï¼š

````markdown
# PR #{NUMBER} åˆ†æç”¨ãƒ‡ãƒ¼ã‚¿

## åŸºæœ¬æƒ…å ±

- **ã‚¿ã‚¤ãƒˆãƒ«**: {title}
- **ä½œæˆè€…**: {author}
- **ä½œæˆæ—¥**: {createdAt}
- **URL**: {url}

## PR æœ¬æ–‡

{body}

## å·®åˆ†å†…å®¹

```diff
{diff}
```
````

## åˆ†ææŒ‡ç¤º

[13 ç¨®é¡ã®æ”¿ç­–ãƒ©ãƒ™ãƒ«ã‹ã‚‰é¸æŠã™ã‚‹æŒ‡ç¤ºã‚’è¨˜è¼‰]

```

#### ã‚¹ãƒ†ãƒƒãƒ— 4: Claude-4-Sonnet ã«ã‚ˆã‚‹åˆ†æ

å„ PR ã«ã¤ã„ã¦ä»¥ä¸‹ã®åˆ¤æ–­åŸºæº–ã§åˆ†æï¼š

1. **PR ã®å†…å®¹ã‚’å…¨ä½“çš„ã«èª­ã‚“ã§ã€ä¸»è¦ãªæ”¿ç­–ãƒ†ãƒ¼ãƒã‚’ç‰¹å®š**
2. **ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®æ§‹æˆã‚„è¨˜è¿°æ–¹æ³•ã«é–¢ã™ã‚‹ææ¡ˆã¯ [ã‚·ã‚¹ãƒ†ãƒ ] ã‚’é¸æŠ**
3. **è¤‡æ•°ã®åˆ†é‡ã«ã¾ãŸãŒã‚‹å ´åˆã¯ã€æœ€ã‚‚ä¸­å¿ƒçš„ãªãƒ†ãƒ¼ãƒã‚’é¸æŠ**
4. **æ”¿ç­–ææ¡ˆã®å…·ä½“çš„ãªå†…å®¹ã‚’é‡è¦–ã—ã¦åˆ¤æ–­**

åˆ†æçµæœã®è¨˜éŒ²å½¢å¼ï¼š
```

é¸æŠã—ãŸãƒ©ãƒ™ãƒ«: [ãƒ©ãƒ™ãƒ«å]
ç†ç”±: [100 æ–‡å­—ç¨‹åº¦ã§é¸æŠç†ç”±ã‚’èª¬æ˜]

````

#### ã‚¹ãƒ†ãƒƒãƒ— 5: YAML ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°

åˆ†æçµæœã‚’ `readme-pr.yaml` ã«åæ˜ ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼š

```python
#!/usr/bin/env python3
# update_analysis.py
import yaml
from datetime import datetime

def update_pr_analysis(analysis_results):
    with open('readme-pr.yaml', 'r', encoding='utf-8') as f:
        data = yaml.safe_load(f)

    analysis_dict = {result['number']: result for result in analysis_results}

    for pr in data['pull_requests']:
        if pr['number'] in analysis_dict:
            analysis = analysis_dict[pr['number']]
            pr['new_label'] = analysis['new_label']
            pr['analysis_notes'] = analysis['analysis_notes']
            pr['classification_reason'] = analysis['classification_reason']

    # çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°
    total_prs = len(data['pull_requests'])
    processed_count = sum(1 for pr in data['pull_requests'] if pr.get('label_updated') == True)

    data['statistics']['processed'] = processed_count
    data['statistics']['unprocessed'] = total_prs - processed_count
    data['statistics']['progress_rate'] = f"{(processed_count / total_prs) * 100:.1f}%"
    data['statistics']['last_updated'] = datetime.now().strftime('%Y-%m-%d %H:%M:%S')

    with open('readme-pr.yaml', 'w', encoding='utf-8') as f:
        yaml.dump(data, f, default_flow_style=False, allow_unicode=True,
                 sort_keys=False, width=1000, indent=2)

# åˆ†æçµæœã®ä¾‹
analysis_results = [
    {
        'number': 1234,
        'new_label': 'æ•™è‚²',
        'analysis_notes': 'æ•™è‚²åˆ¶åº¦æ”¹é©ã«é–¢ã™ã‚‹å…·ä½“çš„ãªæ”¿ç­–ææ¡ˆ',
        'classification_reason': 'PRå†…å®¹ã‚’è©³ç´°åˆ†æã—ãŸçµæœã€æ•™è‚²åˆ†é‡ã®æ”¿ç­–ææ¡ˆã¨åˆ¤å®š'
    }
    # ... ä»–ã®åˆ†æçµæœ
]

update_pr_analysis(analysis_results)
````

#### ã‚¹ãƒ†ãƒƒãƒ— 6: ä½œæ¥­ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´ç†

```bash
# ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
rm -f pr_*_analysis.md analyze_batch.py update_analysis.py

# å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
git add .pr_analysis/readme-pr.yaml
git commit -m "feat: {N}ä»¶ã®PRåˆ†æã‚’å®Œäº† - PR#{é–‹å§‹ç•ªå·}-#{çµ‚äº†ç•ªå·}ã®åˆ†æçµæœã‚’è¿½åŠ "
git push origin pr-classification
```

### âš ï¸ æ³¨æ„äº‹é …

1. **å®Ÿéš›ã®ãƒ©ãƒ™ãƒ«æ›´æ–°ã¯ç¦æ­¢**: `gh pr edit` ã‚³ãƒãƒ³ãƒ‰ã¯å®Ÿè¡Œã—ãªã„
2. **åˆ†æã®ä¸€è²«æ€§**: åŒã˜åŸºæº–ã§åˆ¤æ–­ã‚’è¡Œã†
3. **è©³ç´°ãªè¨˜éŒ²**: åˆ†é¡ç†ç”±ã‚’å¿…ãšè¨˜éŒ²ã™ã‚‹
4. **ãƒãƒƒãƒã‚µã‚¤ã‚º**: ä¸€åº¦ã« 10-20 ä»¶ç¨‹åº¦ã«ç•™ã‚ã‚‹
5. **é€²æ—ç®¡ç†**: çµ±è¨ˆæƒ…å ±ã‚’å¿…ãšæ›´æ–°ã™ã‚‹

### ğŸ” å“è³ªãƒã‚§ãƒƒã‚¯

åˆ†æå®Œäº†å¾Œã€ä»¥ä¸‹ã‚’ç¢ºèªï¼š

```bash
# åˆ†ææ¸ˆã¿PRæ•°ã®ç¢ºèª
grep -c "new_label: " readme-pr.yaml

# å„ãƒ©ãƒ™ãƒ«ã®ä»¶æ•°ç¢ºèª
grep "new_label: " readme-pr.yaml | sort | uniq -c

# æœªåˆ†æPRæ•°ã®ç¢ºèª
grep -c "analysis_notes: æœªåˆ†æ" readme-pr.yaml
```

### ğŸ“Š é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ

ä½œæ¥­å®Œäº†æ™‚ã«ä»¥ä¸‹ã®æƒ…å ±ã‚’å ±å‘Šï¼š

- åˆ†æå¯¾è±¡ PR ç•ªå·ã®ç¯„å›²
- å„ PR ã®åˆ†é¡çµæœï¼ˆãƒ©ãƒ™ãƒ« + ç†ç”±ï¼‰
- å…¨ä½“ã®é€²æ—ç‡
- åˆ†é¡çµ±è¨ˆã®æ›´æ–°çµæœ

ã“ã®æ‰‹é †ã«å¾“ã†ã“ã¨ã§ã€ä¸€è²«æ€§ã®ã‚ã‚‹é«˜å“è³ªãª PR åˆ†æã‚’åŠ¹ç‡çš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚
